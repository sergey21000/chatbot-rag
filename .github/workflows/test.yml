name: Clear memory test

on: workflow_dispatch

permissions:
  contents: write
  packages: write

jobs:
  check-clear:
    runs-on: ubuntu-24.04
    steps:
      - name: Clean up disk space before build
        run: |
          echo "=== Disk usage before cleanup ==="
          df -h
          docker system df
          
          sudo rm -rf /usr/share/dotnet
          sudo rm -rf /usr/local/lib/android
          sudo rm -rf /opt/ghc
          
          echo "=== Disk usage after cleanup ==="
          df -h
          docker system df
          
  check-no-clear:
    runs-on: ubuntu-24.04
    needs: check-clear
    steps:
      - name: Check next job
        run: |
          echo "=== Disk usage before cleanup ==="
          df -h
          docker system df
